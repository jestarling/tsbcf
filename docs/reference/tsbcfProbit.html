<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>tsbcfProbit: tsbart for causal inference for binary responses — tsbcfProbit • tsbart</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="tsbcfProbit: tsbart for causal inference for binary responses — tsbcfProbit" />

<meta property="og:description" content="This function implements the tsbart method for a binary response in the causal inference setting, smoothing over the covariate tgt, with unsmoothed covariates x and treatment indicator z. Predicts function values f(x,t,z) at a set of new time points and covariates.
Augmented model formulation is: y(t) = alpha(t) + eta_m * m(x,t) + eta_a * a(x,t)*z + epsilon
where propensity scores should be included as part of each x matrix of covariates. The output &quot;pmean&quot; gives y-hat(t).  The output &quot;pmean_trt&quot; gives (eta_a * a(x,t)*z).  Probability of success given x and treatment is pnorm(y(t))." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tsbart</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/myvignette.html">tsbart Vignette</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>tsbcfProbit: tsbart for causal inference for binary responses</h1>
    
    <div class="hidden name"><code>tsbcfProbit.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function implements the tsbart method for a binary response in the causal inference setting, smoothing over the covariate tgt, with unsmoothed covariates x and treatment indicator z. Predicts function values f(x,t,z) at a set of new time points and covariates.</p>
<p>Augmented model formulation is: y(t) = alpha(t) + eta_m * m(x,t) + eta_a * a(x,t)*z + epsilon</p>
<p>where propensity scores should be included as part of each x matrix of covariates. The output "pmean" gives y-hat(t).  The output "pmean_trt" gives (eta_a * a(x,t)*z).  Probability of success given x and treatment is pnorm(y(t)).</p>
    
    </div>

    <pre class="usage"><span class='fu'>tsbcfProbit</span>(<span class='no'>y</span>, <span class='no'>yobs</span>, <span class='no'>x</span>, <span class='no'>x_trt</span>, <span class='no'>tgt</span>, <span class='no'>z</span>,
           <span class='no'>xpred</span>, <span class='no'>xpred_trt</span>, <span class='no'>tpred</span>, <span class='no'>zpred</span>,
           <span class='no'>xinfo_list</span>, <span class='no'>xinfo_list_trt</span>,
           <span class='no'>nburn</span>, <span class='no'>nsim</span>, <span class='no'>ntree</span>,
           <span class='no'>lambda</span>, <span class='no'>nu</span>, <span class='no'>ecross</span>, <span class='no'>ecross_trt</span>,
           <span class='no'>treef_name_</span>, <span class='no'>save_trees</span>, <span class='no'>silent_mode</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>A vector with continuous response values. Required,</p></td>
    </tr>
    <tr>
      <th>y_obs</th>
      <td><p>A vector with observed binary 1/0 responses. Required,</p></td>
    </tr>
    <tr>
      <th>z</th>
      <td><p>A vector of 0/1 indicators for each observation. 1 = treatment group, 0 = control group. Required,</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A data frame or matrix containing the covariates for the prognostic effect which are not to be smoothed over. Observations must be in columns. If data frame is set up in usual observations (rows) and covariates (columns) form, input t(x). Required,</p></td>
    </tr>
    <tr>
      <th>x_trt</th>
      <td><p>A data frame or matrix containing the covariates for the treatment effect which are not to be smoothed over. Observations must be in columns. If data frame is set up in usual observations (rows) and covariates (columns) form, input t(x). Required,</p></td>
    </tr>
    <tr>
      <th>tgt</th>
      <td><p>A vector with discrete time points. Required,</p></td>
    </tr>
    <tr>
      <th>xpred</th>
      <td><p>A data frame or matrix containing out of sample covariates.  Observations must be in columns.  If data frame is set up in usual observations (rows) and covariates (columns) form, input t(x). Required,</p></td>
    </tr>
    <tr>
      <th>xpred_trt</th>
      <td><p>A data frame or matrix containing out of sample prognostic covariates. Observations must be in columns. If data frame is set up in usual observations (rows) and covariates (columns) form, input t(x). Required,</p></td>
    </tr>
    <tr>
      <th>tpred</th>
      <td><p>A vector with out of sample discrete time points. Required,</p></td>
    </tr>
    <tr>
      <th>zpred</th>
      <td><p>A vector of 0/1 indicators for each out of sample observation. 1 = treatment group, 0 = control group. Required,</p></td>
    </tr>
    <tr>
      <th>xinfo_list</th>
      <td><p>A list with length matching number of covariates in x.  Each element contains a vector of cutpoints. Can be generated using the helper function makeCutPoints(). Required,</p></td>
    </tr>
    <tr>
      <th>xinfo_list_trt</th>
      <td><p>A list with length matching number of covariates in x_trt. Each element contains a vector of cutpoints. Can be generated using the helper function makeCutPoints(). Required,</p></td>
    </tr>
    <tr>
      <th>nburn</th>
      <td><p>Number of burn-in MCMC iterations.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of MCMC iterations to save after burn-in.</p></td>
    </tr>
    <tr>
      <th>ntree</th>
      <td><p>Number of trees.  Defaults to 200.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Double lambda hyperparameter for sigma^2 prior. When setting, use estimated sigma2 from scaled/centered response if using scale_y=TRUE input.</p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p>Double nu hyperparameter for sigma^2 prior. Required,</p></td>
    </tr>
    <tr>
      <th>ecross</th>
      <td><p>Double number of expected times f(x,t) crosses the mean response over time, alpha(t). We suggest a default value of 1.</p></td>
    </tr>
    <tr>
      <th>ecross_trt</th>
      <td><p>Double number of expected crossings for treatment effect. Required,</p></td>
    </tr>
    <tr>
      <th>treef_name_</th>
      <td><p>Character vector containing file name/path for tree output.  Must be populated, even if save_trees is set to FALSE. (In this case, parameter is ignored.) Required,</p></td>
    </tr>
    <tr>
      <th>save_trees</th>
      <td><p>Boolean for writing trees to a .txt file.  Defaults to true. Defaults to FALSE.</p></td>
    </tr>
    <tr>
      <th>silent_mode</th>
      <td><p>Boolean for writing progress report to console. Defaults to FALSE.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing the following items:</p>
<dt>mcmcdraws</dt><dd><p>A matrix containing the in-sample MCMC draws for the tsbart fit. Rows are MCMC iterations, columns are observations.</p></dd>

<dt>mcmcdraws_trt</dt><dd><p>A matrix containing the in-sample MCMC draws for the treatment effect. Rows are MCMC iterations, columns are observations.</p></dd>

<dt>mcmcdraws_oos</dt><dd><p>A matrix containing the out-of-sample MCMC draws for the tsbart fit. Rows are MCMC iterations, columns are observations.</p></dd>

<dt>mcmcdraws_oos_trt</dt><dd><p>A matrix containing the out-of-sample MCMC draws for the treatment effect. Rows are MCMC iterations, columns are observations.</p></dd>

<dt>eta_m</dt><dd><p>A vector containing the MCMC draws for eta_m .</p></dd>

<dt>eta_a</dt><dd><p>A vector containing the MCMC draws for eta_a .</p></dd>

<dt>gamma_m</dt><dd><p>A vector containing the MCMC draws for gamma_m .</p></dd>

<dt>gamma_a</dt><dd><p>A vector containing the MCMC draws for gamma_a .</p></dd>

<dt>postpred</dt><dd><p>A matrix of posterior predictive draws for in-sample data. Rows are MCMC iterations, columns are observations.</p></dd>

<dt>postpred_oos</dt><dd><p>A matrix of posterior predictive draws for out-of-sample data. Rows are MCMC iterations, columns are observations.</p></dd>

    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"># NOT RUN {
See vignette for full example, including expected crossings parameter tuning.
Function call example is as follows.

Function call example is as follows.

# Calibrate BART's error variance a la CGM 2010 (method 2)
df = data.frame(xx, y)
lmf = lm(y~.,df)
sighat = sigma(lmf) #sd(y) #summary(lmf)$sigma

# Hyperparameters
nu = 3
sigq = .9
qchi = qchisq(1.0-sigq,nu)
lambda = (sighat*sighat*qchi)/nu

# Decision rule cutpoints for each predictor.
cutpoints = makeCutpoints(xx)

# Fit model
fit = tsbcfProbit(y = y,
                    yobs = yobs,
                    x = t(xx),     # observations must be in columns
                    x_trt = t(xx),
                    tgt = ti,
                    z = z,
                    xpred = t(xpred),
                    xpred_trt = t(xpred),
                    tpred = ti_pred,
                    zpred = z_pred,
                    xinfo_list = cutpoints,
                    xinfo_list_trt = cutpoints,
                    nburn = nburn, nsim = nsim, ntree = ntree, m_trt = m_trt,
                    lambda=lambda, nu=nu, ecross = exp_cross, ecross_trt = .5,
                    treef_name_ =  paste0(out.csv,'trees.txt'))

# }
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jennifer E. Starling</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jennifer Starling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

