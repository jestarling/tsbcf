<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tsbart Vignette • tsbart</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tsbart Vignette">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tsbart</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/myvignette.html">tsbart Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>tsbart Vignette</h1>
            
      
      
      <div class="hidden name"><code>myvignette.Rmd</code></div>

    </div>

    
    
<p>This vignette provides a walk-through of fitting the Targeted Smooth BART model to a simulated data set using the tsbart package.</p>
<div id="simulated-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-data-set" class="anchor"></a>Simulated data set</h2>
<p>We begin by loading a simulated data set, which we will use to illustrate how to use the Targeted Smooth BART method and the <strong>tsbart</strong> package.</p>
<p>Data contains four ‘x’ covariates; each pair is simulated from bivariate Gaussians with moderate correlation and unit variance. Each observation has one corresponding time point at which it is observed, randomly chosen from eight discrete time points.</p>
<p>Function values are calculated as <span class="math inline">\(f(x,t) = g(x_1,x_2) \cdot cos(t + 2 \pi h(x_3,x_4))\)</span> where <span class="math inline">\(g(x_1,x_2)\)</span> and <span class="math inline">\(h(x_3,x_4)\)</span> represent sums of the covariate pairs.</p>
<p>In this configuration, <span class="math inline">\(g(x_1,x_2)\)</span> controls amplitude, and <span class="math inline">\(h(x_3,x_3)\)</span> controls phase shift.</p>
<p>The data set contains <span class="math inline">\(n=1000\)</span> observations and <span class="math inline">\(T=8\)</span> distinct time points. Variables included in the data set are</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="78%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>y</td>
<td>The observed value; functional response plus noise.</td>
</tr>
<tr class="even">
<td>ti</td>
<td>The time associated with each observation.</td>
</tr>
<tr class="odd">
<td>fx</td>
<td>The true underlying function value, without noise.</td>
</tr>
<tr class="even">
<td>eps</td>
<td>Standard normal noise.</td>
</tr>
<tr class="odd">
<td>
<span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, <span class="math inline">\(x_3\)</span>, <span class="math inline">\(x_4\)</span>
</td>
<td>The four covariates; x1 and x2 are a correlated pair, as are x3 and x4.</td>
</tr>
<tr class="even">
<td>id</td>
<td>Unique identifiers for each row.</td>
</tr>
<tr class="odd">
<td>train</td>
<td>Splits data into 70% (train), 30% (test).</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">sim =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.csv</a></span>(<span class="st">"sim.csv"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sim <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(y,ti,fx,x1,x2,x3,x4,id))</a></code></pre></div>
<pre><code>##            y ti          fx          x1         x2         x3         x4
## 1  1.7824040  6  0.76553358 -1.10776147 -1.4300971 -2.5264193 -0.2615409
## 2 -0.1305318  3 -0.91196231 -0.82007937 -0.4301415 -1.2612625 -0.1500290
## 3 -2.6617458  8 -1.07411270 -0.08444446 -0.6749731 -0.4975946 -0.2275862
## 4 -0.2596328  6 -0.81073593 -1.13081866 -0.2856186  0.1469258  1.7693068
## 5 -1.0914732  3 -1.26686641 -0.46868413  1.0797134 -1.2567631 -1.5386179
## 6  0.9952693  1 -0.09395325  0.19053333  0.4109485 -0.9288042 -0.5324654
##   id
## 1  1
## 2  2
## 3  3
## 4  4
## 5  5
## 6  6</code></pre>
</div>
<div id="workspace-prep" class="section level2">
<h2 class="hasAnchor">
<a href="#workspace-prep" class="anchor"></a>Workspace prep</h2>
<p>We begin by setting up our test and train data sets.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Set up train and test data sets.</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">train =<span class="st"> </span>sim <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(train<span class="op">==</span><span class="st">'train'</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">test =<span class="st"> </span>sim <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(train<span class="op">==</span><span class="st">'test'</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># Set up covariates.</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">xcols =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substr">substr</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(train),<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">==</span><span class="st">"x"</span>) <span class="co"># Choose only cols x1, x2, x3, x4.</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">xx =<span class="st"> </span>train[xcols]; x_pred =<span class="st"> </span>test[xcols]         <span class="co"># Set up model matrices.</span></a></code></pre></div>
<p>If we had factor covariates, we can use the utility function makeModelMatrix() to construct our model matrix. We do not need to do this; the <em>tsbart()</em> function does it automatically for us.</p>
<pre><code>xx = makeModelMatrix(train[xcols])
x_pred = makeModelMatrix(test[xcols])</code></pre>
</div>
<div id="hyperparameters-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#hyperparameters-setup" class="anchor"></a>Hyperparameters setup</h2>
<p>We set hyperparameters as recommended in Chipman, George, and McCulloch (2010). We could only supply sigq and nu, leaving lambda and sighat as NULL; in this case, lambda and sighat are calibrated in the same way as shown here.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Calibrate BART's error variance a la CGM 2010 (method 2)</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">df =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(xx, <span class="st">'t'</span>=train<span class="op">$</span>ti, <span class="st">'y'</span>=train<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">lmf =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(y<span class="op">~</span>.,df)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">sighat =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sigma">sigma</a></span>(lmf) </a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co"># Hyperparameters</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">nu =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">sigq =<span class="st"> </span><span class="fl">.9</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">qchi =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Chisquare">qchisq</a></span>(<span class="fl">1.0</span><span class="op">-</span>sigq,nu)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">lambda =<span class="st"> </span>(sighat<span class="op">*</span>sighat<span class="op">*</span>qchi)<span class="op">/</span>nu</a></code></pre></div>
</div>
<div id="tune-length-scale-via-the-expected-number-of-crossings" class="section level2">
<h2 class="hasAnchor">
<a href="#tune-length-scale-via-the-expected-number-of-crossings" class="anchor"></a>Tune length-scale via the expected number of crossings</h2>
<p>We use WAIC to tune the expected number of crossings, which dictates the length-scale parameter for the Gaussian Process prior in Targeted Smooth BART. This approach consists of several steps (discussed in further detail in the paper). Note: this does not need to consist of a separate step, as the <em>tsbart()</em> function can perform tuning if indicated by the input <em>ecross=“tune”</em>. However, using the separate function provides a bit more flexibility, in that you can specify that the grid of candidate values, and provides a tuning plot and grid as part of the output.</p>
<p>Parameter setting consists of the following steps, all performed by the <em>ecrossTune()</em> function. 1. Set a grid of candidate expected crossing values.<br>
2. Fit the Targeted Smooth BART model using each candidate value. 3. Fit a smooth function to the WAIC results across the grid of candidate values.<br>
4. Calculate the residuals of the smooth function fit, and let <span class="math inline">\(sd = sd(residuals)\)</span>. 5. Select the optimal expected number of crossings value as the smallest where the corresponding WAIC is less than the minimum of the fitted curve plus sd.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Evaluate optimal number of crossings.</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">ecross_candidates =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(.<span class="dv">5</span>,<span class="dv">3</span>,<span class="dt">by=</span>.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">ecrossTune =<span class="st"> </span><span class="kw">tuneEcross</span>(ecross_candidates,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                        <span class="dt">y=</span>train<span class="op">$</span>y, <span class="dt">tgt=</span>train<span class="op">$</span>ti, <span class="dt">tpred=</span>test<span class="op">$</span>ti, <span class="dt">x=</span>xx, <span class="dt">xpred=</span>x_pred,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                        <span class="dt">nburn=</span><span class="dv">100</span>, <span class="dt">nsim=</span><span class="dv">100</span>, <span class="dt">ntree=</span><span class="dv">200</span>,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">                        <span class="dt">lambda=</span>lambda, <span class="dt">sigq=</span>sigq, <span class="dt">sighat=</span>sighat, <span class="dt">nu=</span>nu,</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">                        <span class="dt">base_tree=</span>.<span class="dv">95</span>, <span class="dt">power_tree=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">                        <span class="dt">probit=</span><span class="ot">FALSE</span>, <span class="dt">yobs=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co"># Set expected number of crossings.</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">exp_cross =<span class="st"> </span>ecrossTune[[<span class="st">"ecross_opt"</span>]]</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co"># Print plot.</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(ecrossTune[[<span class="st">"waic_plot"</span>]])</a></code></pre></div>
<p><img src="myvignette_files/figure-html/ecrosstune-1.png" width="576"></p>
</div>
<div id="fit-targeted-smooth-bart-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-targeted-smooth-bart-model" class="anchor"></a>Fit Targeted Smooth BART Model</h2>
<p>We are now ready to fit the Targeted Smooth BART model. Had we not done the previous parameter tuning, we could tune here by setting ecross=“tune”.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">fit =<span class="st"> </span><span class="kw">tsbart</span>(<span class="dt">y=</span>train<span class="op">$</span>y, <span class="dt">tgt=</span>train<span class="op">$</span>ti, <span class="dt">tpred=</span>test<span class="op">$</span>ti, <span class="dt">x=</span>xx, <span class="dt">xpred=</span>x_pred,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">             <span class="dt">nburn=</span><span class="dv">250</span>, <span class="dt">nsim=</span><span class="dv">500</span>, <span class="dt">ntree=</span><span class="dv">200</span>, <span class="dt">lambda=</span>lambda, <span class="dt">sigq=</span>.<span class="dv">9</span>, <span class="dt">nu=</span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb7-3" data-line-number="3">             <span class="dt">ecross=</span>exp_cross, <span class="dt">base_tree=</span>.<span class="dv">95</span>, <span class="dt">power_tree=</span><span class="dv">2</span>, </a>
<a class="sourceLine" id="cb7-4" data-line-number="4">             <span class="dt">probit=</span>F, <span class="dt">yobs=</span><span class="ot">NULL</span>, <span class="dt">verbose=</span>F)</a></code></pre></div>
</div>
<div id="plot-out-of-sample-functions-over-time-" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-out-of-sample-functions-over-time-" class="anchor"></a>Plot out of sample functions over time.</h2>
<p>We select a few observations from the test data, which are observed at each time point, to construct a plot of the out-of-sample Targeted Smooth BART fits.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Set up data frames for plotting out of sample curves over time.</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">ggdf_pred =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind.data.frame</a></span>(</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">   <span class="st">'id'</span> =<span class="st"> </span>test<span class="op">$</span>id,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">   <span class="st">'t'</span> =<span class="st"> </span>test<span class="op">$</span>ti,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">   <span class="st">'y'</span> =<span class="st"> </span>test<span class="op">$</span>y,</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">   <span class="st">'fx'</span> =<span class="st"> </span>test<span class="op">$</span>fx,</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">   <span class="st">'pmean'</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(fit[[<span class="st">"mcmcdraws_oos"</span>]], <span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(x)),</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">   <span class="st">'lb'</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(fit[[<span class="st">"mcmcdraws_oos"</span>]], <span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x,.<span class="dv">025</span>)),</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">   <span class="st">'ub'</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(fit[[<span class="st">"mcmcdraws_oos"</span>]], <span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x,.<span class="dv">975</span>)),</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">    x_pred</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co"># Select a few IDs to include.</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14">id_sel =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">9</span>,<span class="dv">42</span>,<span class="dv">60</span>,<span class="dv">79</span>,<span class="dv">83</span>,<span class="dv">91</span>,<span class="dv">94</span>,<span class="dv">98</span>)</a>
<a class="sourceLine" id="cb8-15" data-line-number="15"></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co"># Plot out-of-sample fit for each curve over time, for combos of covariates x.</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="kw">ggplot</span>(ggdf_pred <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(id <span class="op">%in%</span><span class="st"> </span>id_sel)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="st">   </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pmean, <span class="dt">x =</span> t, <span class="dt">colour=</span><span class="st">'pmean'</span>), <span class="dt">linetype=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">stat=</span><span class="st">"identity"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="st">   </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>fx, <span class="dt">x=</span>t, <span class="dt">colour=</span><span class="st">'fx'</span>), <span class="dt">linetype=</span><span class="dv">2</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">stat=</span><span class="st">"identity"</span>,<span class="dt">alpha=</span>.<span class="dv">85</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="st">   </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>lb,<span class="dt">ymax=</span>ub, <span class="dt">x=</span>t),<span class="dt">alpha=</span><span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="st">   </span><span class="kw">facet_wrap</span>(<span class="op">~</span>id,<span class="dt">ncol=</span><span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="st">   </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"firebrick3"</span>,<span class="st">"grey10"</span>), </a>
<a class="sourceLine" id="cb8-23" data-line-number="23">                       <span class="dt">labels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'Function value'</span>,<span class="st">'tsBART estimate'</span>), <span class="dt">name=</span><span class="st">''</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="st">   </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="st">"grey80"</span>, <span class="dt">guide=</span><span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">'time (t)'</span>,</a>
<a class="sourceLine" id="cb8-26" data-line-number="26">        <span class="dt">y=</span><span class="st">'f(x;t)'</span>,</a>
<a class="sourceLine" id="cb8-27" data-line-number="27">        <span class="dt">title =</span> <span class="st">'tsBART Out of Sample Fit'</span>)</a></code></pre></div>
<p><img src="myvignette_files/figure-html/timeplot-1.png" width="576"></p>
</div>
<div id="probit-targeted-smooth-bart" class="section level2">
<h2 class="hasAnchor">
<a href="#probit-targeted-smooth-bart" class="anchor"></a>Probit Targeted Smooth BART</h2>
<p>The process for fitting Targeted Smooth BART with a binary response is very similar. The tsbart() function can be used, with y set to the length-n vector of initial latent values, yobs set to the observed binary responses, and probit set to TRUE.</p>
<p>If latent y values are unknown, as is usually the case, initializing at values of 1.96 and -1.96, corresponding to the observed 1 and 0 y values, is effective.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simulated-data-set">Simulated data set</a></li>
      <li><a href="#workspace-prep">Workspace prep</a></li>
      <li><a href="#hyperparameters-setup">Hyperparameters setup</a></li>
      <li><a href="#tune-length-scale-via-the-expected-number-of-crossings">Tune length-scale via the expected number of crossings</a></li>
      <li><a href="#fit-targeted-smooth-bart-model">Fit Targeted Smooth BART Model</a></li>
      <li><a href="#plot-out-of-sample-functions-over-time-">Plot out of sample functions over time.</a></li>
      <li><a href="#probit-targeted-smooth-bart">Probit Targeted Smooth BART</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jennifer Starling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
